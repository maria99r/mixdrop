<app-navbar></app-navbar>

<button (click)="emparejar()">Emparejamiento</button>

<div class="cabecera">
    <img [src]="IMG_URL + user?.AvatarPath" alt="avatar de usuario">
    <span style="font-size: 2rem;">{{user?.Nickname}}</span> <!-- nickname del usuario-->
</div>

<!-- contenido -->
<div class="container">

    <!-- MENU LATERAL -->
    <aside>
        <div (click)=" menuSelector='myFriends'">
            <img src="/images/amigos.png" alt="icono amigo"> Tus amigos
        </div>
        <div (click)="menuSelector='searchUsers'">
            <img src="/images/buzon.png" alt="icono buzon"> AÃ±adir a un amigo
        </div>
        <div (click)="menuSelector='friendRequest'">
            <img src="/images/invitacion.png" alt="icono carta"> Solicitudes de amistad
        </div>
        <div (click)="menuSelector='battleRequest'">
            <img src="/images/juego.png" alt="icono juego"> Solicitudes de batalla
        </div>
    </aside>


    <!-- CONTENIDO -->

    <section>
        @switch (menuSelector) {
        <!-- LISTA DE AMIGOS-->
        @case ('myFriends') {

        <div class="amigos">
            <div>
                <span>TUS AMIGOS</span>
            </div>

            <form (submit)="(queryfriend)">
                <input type="text" placeholder="Buscar amigos" class="icon-input" required [(ngModel)]="queryfriend"
                    [ngModelOptions]="{standalone: true}" />
                <button type="submit"> Buscar</button>
            </form>
        </div>
        }

        <!-- BUSCAR USUARIOS-->
        @case ('searchUsers') {
        <div class="busquedaUsuarios">
            <div>
                <span>BUSCAR USUARIO</span>
            </div>
            <form (submit)="getSearchedUsers(queryuser)">
                <input type="text" placeholder="Buscar usuarios" class="icon-input" required [(ngModel)]="queryuser"
                    [ngModelOptions]="{standalone: true}" />
                <button type="submit" [disabled]="!queryuser"> Buscar</button>
            </form>

            @if (searchedUsers) {

            @if (searchedUsers.length<1) { <p> No se encontraton usuarios</p>
                }
                @else {
                @for (user of searchedUsers; track $index)
                {
                <div class="usuarioBuscado">
                    <img [src]="IMG_URL + user?.AvatarPath" alt="usuario avatar" width="50px">
                    {{user.Nickname}}
                </div>
                }
                }
                }
        </div>
        }

        <!-- SOLICITUDES DE AMISTAD-->
        @case ('friendRequest') {
        SOLICITUDES DE AMISTAD
            @for(friend of pendingFriends; track friend.Id)
            {
                <div>
                    <p>Nombre: {{ friend.SenderUser?.Nickname || friend.ReceiverUser?.Nickname }}</p>
                    <button (click)="acceptFriendship(friend.Id)">Aceptar solicitud</button>
                    <button (click)="removeFriend(friend)">Eliminar solicitud</button>
                </div>
            
            }
        }

        <!-- SOLICITUDES DE BATALLA-->
        @case ('battleRequest') {
        SOLICITUDES DE BATALLA
        }
        }

    </section>
</div>
<br><br><br><br>
<div>
    <button (click)="askForInfo(0)">Pedir dato 1</button>
    <button (click)="askForInfo(1)">Pedir dato 2</button>
    <button (click)="askForInfo(2)">Pedir dato 3</button>
    <p>{{ serverResponse }}</p>
    <p>Total de jugadores: {{ totalPlayers }}</p>
</div>


<br><br><br><br>
<div class="busquedaUsuarios">
    <form (submit)="getSearchedUsers(queryuser)">
        <input type="text" placeholder="Buscar usuarios" class="icon-input" required [(ngModel)]="queryuser"
            [ngModelOptions]="{standalone: true}" />
        <button type="submit" [disabled]="!queryuser"> Buscar</button>
    </form>

    @if (searchedUsers) {

    @if (searchedUsers.length<1) { <p> No se encontraton usuarios</p>
        }
        @else {
        @for (user of searchedUsers; track $index)
        {
        <div class="usuarioBuscado">
            <img [src]="IMG_URL + user?.AvatarPath" alt="usuario avatar" width="50px">
            {{user.Nickname}}
            <button (click)="addFriend(user)">Agregar amigo</button>
        </div>
        }
        }
        }
</div>
